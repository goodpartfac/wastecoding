<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡πÄ‡∏Å‡∏°‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞ - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ß‡∏±‡∏í‡∏ô‡∏≤</title>
    <style>
        /* --- CSS: ‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÄ‡∏Å‡∏° --- */
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap');

        body {
            font-family: 'Sarabun', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #a8e6cf 0%, #dcedc1 100%);
            overflow: hidden; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
            touch-action: none; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏π‡∏°‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* 3D Container Style */
        .container {
            width: 95%;
            height: 95%;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* --- Header Section --- */
        header {
            background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 10;
        }

        .school-logo {
            height: 60px;
            vertical-align: middle;
            margin-right: 10px;
            background-color: #fff;
            border-radius: 50%;
            padding: 2px;
        }
        
        /* Fallback for logo if image missing */
        .school-logo:not([src]){
            display: inline-block;
            width: 60px;
            height: 60px;
            background: #eee;
            border-radius: 50%;
            content: 'Logo';
            line-height: 60px;
            color: #333;
            font-size: 10px;
        }

        h1, h2, h3 { margin: 0; line-height: 1.2; }
        h1 { font-size: 1.2rem; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.2); }
        h2 { font-size: 1rem; color: #fff; }
        h3 { font-size: 0.9rem; font-weight: normal; color: #e0f7fa; }

        /* --- Screens (Start, Game, End) --- */
        .screen {
            flex: 1;
            display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            position: relative;
        }

        .active { display: flex; }

        /* --- Start Screen Form --- */
        .form-group {
            margin: 10px 0;
            width: 80%;
            max-width: 400px;
        }
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Sarabun', sans-serif;
            box-sizing: border-box;
        }
        .btn-start, .btn-restart {
            background: #ff9800;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 0 #e65100, 0 10px 10px rgba(0,0,0,0.2);
            transition: transform 0.1s;
            margin-top: 20px;
            font-weight: bold;
        }
        .btn-start:active {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #e65100;
        }

        /* --- Game Area --- */
        .game-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            padding: 10px 20px;
            box-sizing: border-box;
            background: #f0f0f0;
            font-weight: bold;
            font-size: 1.2rem;
            color: #333;
        }

        .bins-container {
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            width: 100%;
            flex: 1;
            padding-bottom: 20px;
        }

        .bin {
            width: 22%;
            height: 180px;
            background-size: contain;
            background-position: center bottom;
            background-repeat: no-repeat;
            position: relative;
            transition: transform 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
        }

        /* CSS Fallback for bins if images missing */
        .bin-green { background-color: rgba(76, 175, 80, 0.2); border-bottom: 5px solid #4CAF50; }
        .bin-blue { background-color: rgba(33, 150, 243, 0.2); border-bottom: 5px solid #2196F3; }
        .bin-yellow { background-color: rgba(255, 235, 59, 0.2); border-bottom: 5px solid #FBC02D; }
        .bin-red { background-color: rgba(244, 67, 54, 0.2); border-bottom: 5px solid #F44336; }

        .bin img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            pointer-events: none; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡∏ñ‡∏±‡∏á */
        }

        .bin-label {
            background: white;
            padding: 2px 5px;
            border-radius: 5px;
            font-size: 0.8rem;
            margin-bottom: -20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            font-weight: bold;
            text-align: center;
            white-space: nowrap;
        }

        /* --- Garbage Item (Draggable) --- */
        #garbage-item {
            width: 120px;
            height: 80px;
            background: white;
            border: 3px solid #333;
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 8px 15px rgba(0,0,0,0.3);
            position: absolute;
            top: 20%; 
            left: 50%;
            transform: translate(-50%, -50%);
            cursor: grab;
            z-index: 100;
            user-select: none;
            touch-action: none; /* ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
        }
        #garbage-item:active { cursor: grabbing; }

        /* --- Result Screen --- */
        .result-box {
            text-align: center;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            width: 80%;
            max-height: 80vh;
            overflow-y: auto;
        }
        .stars { font-size: 3rem; color: #ffd700; margin: 10px 0; }
        .score-text { font-size: 2rem; font-weight: bold; color: #333; }
        .knowledge-box {
            text-align: left;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 0.9rem;
        }
        .knowledge-item { margin-bottom: 5px; }
        .k-color { font-weight: bold; display: inline-block; width: 60px; }

        /* Animation classes */
        .shake { animation: shake 0.5s; }
        .pop { animation: pop 0.3s; }

        @keyframes shake {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            25% { transform: translate(-55%, -50%) rotate(-5deg); }
            75% { transform: translate(-45%, -50%) rotate(5deg); }
            100% { transform: translate(-50%, -50%) rotate(0deg); }
        }
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

    </style>
</head>
<body>

<div class="container">
    <header>
        <div style="display: flex; align-items: center; justify-content: center;">
            <img src="logo.png" alt="Logo" class="school-logo" onerror="this.style.display='none'">
            <div>
                <h1>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ß‡∏±‡∏í‡∏ô‡∏≤</h1>
                <h2>‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô: ‡∏Ñ‡∏£‡∏π‡∏Ç‡∏±‡∏ô‡∏ó‡∏≠‡∏á ‡πÇ‡∏û‡∏ò‡∏¥‡πå‡πÄ‡∏ï‡∏µ‡πâ‡∏¢</h2>
                <h3>‡∏ß‡∏¥‡∏ä‡∏≤‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡∏¥‡πâ‡∏á)</h3>
            </div>
        </div>
    </header>

    <div id="start-screen" class="screen active">
        <h2 style="color:#333; font-size:1.5rem; margin-bottom:20px;">‡πÄ‡∏Å‡∏°‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞ ‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å</h2>
        
        <div class="form-group">
            <input type="text" id="studentName" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">
        </div>
        <div class="form-group">
            <input type="text" id="studentID" placeholder="‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" inputmode="numeric">
        </div>
        <div class="form-group">
            <select id="studentClass">
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô --</option>
                <option value="‡∏õ.1">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</option>
                <option value="‡∏õ.2">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2</option>
                <option value="‡∏õ.3">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3</option>
                <option value="‡∏õ.4">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4</option>
                <option value="‡∏õ.5">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 5</option>
                <option value="‡∏õ.6">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 6</option>
            </select>
        </div>
        <button class="btn-start" onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°</button>
    </div>

    <div id="game-screen" class="screen">
        <div class="game-info">
            <div id="player-display" style="font-size: 0.9rem;">‡∏ô‡πâ‡∏≠‡∏á... ‡∏ä‡∏±‡πâ‡∏ô...</div>
            <div style="color: #d32f2f;">‡πÄ‡∏ß‡∏•‡∏≤: <span id="timer">60</span> ‡∏ß‡∏¥</div>
            <div style="color: #388e3c;">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="score">0</span></div>
        </div>

        <div id="garbage-item">
            <span id="garbage-text">‡∏Ç‡∏¢‡∏∞</span>
        </div>

        <div class="bins-container">
            <div class="bin bin-green" id="bin-green">
                <img src="bin_green.png" alt="‡∏ñ‡∏±‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß" onerror="this.style.display='none'; this.parentElement.innerText='‡∏ñ‡∏±‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß\n(‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå)'; this.parentElement.style.color='#1b5e20'; this.parentElement.style.justifyContent='center';">
                <div class="bin-label" style="color:#2e7d32">‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå</div>
            </div>
            <div class="bin bin-blue" id="bin-blue">
                <img src="bin_blue.png" alt="‡∏ñ‡∏±‡∏á‡∏ü‡πâ‡∏≤" onerror="this.style.display='none'; this.parentElement.innerText='‡∏ñ‡∏±‡∏á‡∏ü‡πâ‡∏≤\n(‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•)'; this.parentElement.style.color='#0d47a1'; this.parentElement.style.justifyContent='center';">
                <div class="bin-label" style="color:#1565c0">‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•</div>
            </div>
            <div class="bin bin-yellow" id="bin-yellow">
                <img src="bin_yellow.png" alt="‡∏ñ‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á" onerror="this.style.display='none'; this.parentElement.innerText='‡∏ñ‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á\n(‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)'; this.parentElement.style.color='#f57f17'; this.parentElement.style.justifyContent='center';">
                <div class="bin-label" style="color:#f9a825">‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</div>
            </div>
            <div class="bin bin-red" id="bin-red">
                <img src="bin_red.png" alt="‡∏ñ‡∏±‡∏á‡πÅ‡∏î‡∏á" onerror="this.style.display='none'; this.parentElement.innerText='‡∏ñ‡∏±‡∏á‡πÅ‡∏î‡∏á\n(‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢)'; this.parentElement.style.color='#b71c1c'; this.parentElement.style.justifyContent='center';">
                <div class="bin-label" style="color:#c62828">‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</div>
            </div>
        </div>
    </div>

    <div id="end-screen" class="screen">
        <div class="result-box">
            <h2 style="color:#333;">‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡πâ‡∏ß!</h2>
            <div class="stars" id="final-stars">‚≠ê‚≠ê‚≠ê</div>
            <div class="score-text">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="final-score">0</span></div>
            <h3 id="pass-status" style="margin:10px 0; font-size:1.5rem;"></h3>
            
            <div class="knowledge-box">
                <h4 style="margin-top:0;">üí° ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞</h4>
                <div class="knowledge-item"><span class="k-color" style="color:green">‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß</span> : ‡πÄ‡∏®‡∏©‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡πÉ‡∏ö‡πÑ‡∏°‡πâ -> ‡∏ó‡∏≥‡∏õ‡∏∏‡πã‡∏¢‡∏´‡∏°‡∏±‡∏Å</div>
                <div class="knowledge-item"><span class="k-color" style="color:blue">‡∏™‡∏µ‡∏ü‡πâ‡∏≤</span> : ‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å ‡πÅ‡∏Å‡πâ‡∏ß ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© -> ‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•</div>
                <div class="knowledge-item"><span class="k-color" style="color:#fbc02d">‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á</span> : ‡∏ñ‡∏∏‡∏á‡∏Ç‡∏ô‡∏° ‡∏ú‡πâ‡∏≤ ‡∏¢‡∏≤‡∏á -> ‡∏Ç‡∏¢‡∏∞‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</div>
                <div class="knowledge-item"><span class="k-color" style="color:red">‡∏™‡∏µ‡πÅ‡∏î‡∏á</span> : ‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü ‡∏ñ‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏â‡∏≤‡∏¢ -> ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</div>
            </div>

            <button class="btn-restart" onclick="location.reload()">‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        </div>
    </div>
</div>

<script>
    /* --- Javascript Logic --- */
    
    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏¢‡∏∞ (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà)
    const garbageData = [
        // type: green, blue, yellow, red
        { name: "‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤", type: "green" },
        { name: "‡πÄ‡∏®‡∏©‡∏Ç‡πâ‡∏≤‡∏ß", type: "green" },
        { name: "‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡πâ‡∏ß‡∏¢", type: "green" },
        { name: "‡πÉ‡∏ö‡πÑ‡∏°‡πâ‡πÅ‡∏´‡πâ‡∏á", type: "green" },
        { name: "‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏Ç‡πà", type: "green" },
        
        { name: "‡∏Ç‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å", type: "blue" },
        { name: "‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏•‡∏±‡∏á", type: "blue" },
        { name: "‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏≠‡∏±‡∏î‡∏•‡∏°", type: "blue" },
        { name: "‡∏Ç‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏ß", type: "blue" },
        { name: "‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå", type: "blue" },
        
        { name: "‡∏ñ‡∏∏‡∏á‡∏Ç‡∏ô‡∏°‡∏Ç‡∏ö‡πÄ‡∏Ñ‡∏µ‡πâ‡∏¢‡∏ß", type: "yellow" },
        { name: "‡πÄ‡∏®‡∏©‡∏ú‡πâ‡∏≤", type: "yellow" },
        { name: "‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÇ‡∏ü‡∏°‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô", type: "yellow" },
        { name: "‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô‡πÅ‡∏Å‡∏á", type: "yellow" },
        { name: "‡πÄ‡∏®‡∏©‡∏¢‡∏≤‡∏á‡∏•‡∏ö", type: "yellow" },
        
        { name: "‡∏ñ‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏â‡∏≤‡∏¢", type: "red" },
        { name: "‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü‡πÅ‡∏ï‡∏Å", type: "red" },
        { name: "‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡∏™‡πÄ‡∏õ‡∏£‡∏¢‡πå", type: "red" },
        { name: "‡∏Ç‡∏ß‡∏î‡∏¢‡∏≤‡∏Ü‡πà‡∏≤‡πÅ‡∏°‡∏•‡∏á", type: "red" },
        { name: "‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠", type: "red" }
    ];

    let score = 0;
    let timeLeft = 60;
    let timerInterval;
    let currentItem = null;
    let isDragging = false;
    let startX, startY, initialLeft, initialTop;

    const dragItem = document.getElementById("garbage-item");
    const bins = {
        green: document.getElementById("bin-green"),
        blue: document.getElementById("bin-blue"),
        yellow: document.getElementById("bin-yellow"),
        red: document.getElementById("bin-red")
    };

    // ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏π‡∏î (Text-to-Speech)
    function speak(text) {
        if ('speechSynthesis' in window) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'th-TH'; // ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
            utterance.rate = 1.0; // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥
            window.speechSynthesis.speak(utterance);
        }
    }

    function startGame() {
        const name = document.getElementById("studentName").value;
        const sClass = document.getElementById("studentClass").value;
        const sID = document.getElementById("studentID").value;

        if (!name || !sClass || !sID) {
            alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
            return;
        }

        // Setup ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
        document.getElementById("start-screen").classList.remove("active");
        document.getElementById("game-screen").classList.add("active");
        document.getElementById("player-display").innerText = `‡∏ô‡πâ‡∏≠‡∏á${name} (${sClass}) ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${sID}`;

        score = 0;
        timeLeft = 60;
        updateScore();
        spawnGarbage();

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤
        timerInterval = setInterval(() => {
            timeLeft--;
            document.getElementById("timer").innerText = timeLeft;
            if (timeLeft <= 0) {
                endGame();
            }
        }, 1000);
        
        speak("‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö");
    }

    function spawnGarbage() {
        // ‡∏™‡∏∏‡πà‡∏°‡∏Ç‡∏¢‡∏∞
        const randomIndex = Math.floor(Math.random() * garbageData.length);
        currentItem = garbageData[randomIndex];
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
        const itemEl = document.getElementById("garbage-item");
        document.getElementById("garbage-text").innerText = currentItem.name;
        
        // Reset ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠)
        itemEl.style.top = "20%";
        itemEl.style.left = "50%";
        itemEl.style.transform = "translate(-50%, -50%)";
        itemEl.style.backgroundColor = "white"; // Reset color
        itemEl.classList.add("pop"); // Animation
        setTimeout(() => itemEl.classList.remove("pop"), 300);
    }

    function updateScore() {
        document.getElementById("score").innerText = score;
    }

    function endGame() {
        clearInterval(timerInterval);
        document.getElementById("game-screen").classList.remove("active");
        document.getElementById("end-screen").classList.add("active");
        
        document.getElementById("final-score").innerText = score;
        
        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏î‡∏≤‡∏ß
        let stars = "";
        let passText = "";
        let passColor = "";

        if (score >= 20) { stars = "‚≠ê‚≠ê‚≠ê"; passText = "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå"; passColor = "green"; }
        else if (score >= 10) { stars = "‚≠ê‚≠ê"; passText = "‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå"; passColor = "green"; }
        else if (score >= 5) { stars = "‚≠ê"; passText = "‡∏û‡∏≠‡πÉ‡∏ä‡πâ (‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î)"; passColor = "orange"; }
        else { stars = "‚ùå"; passText = "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå (‡∏™‡∏π‡πâ‡πÜ‡∏ô‡∏∞)"; passColor = "red"; }

        document.getElementById("final-stars").innerText = stars;
        const statusEl = document.getElementById("pass-status");
        statusEl.innerText = passText;
        statusEl.style.color = passColor;
        
        if(score >= 10) speak("‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≠‡∏ö‡∏ú‡πà‡∏≤‡∏ô");
        else speak("‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö");
    }

    // --- Drag and Drop Logic (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á Mouse ‡πÅ‡∏•‡∏∞ Touch) ---

    function handleStart(e) {
        // e.preventDefault(); // ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÉ‡∏™‡πà ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
        if(e.target !== dragItem && !dragItem.contains(e.target)) return;
        
        isDragging = true;
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;

        startX = clientX;
        startY = clientY;
        
        const rect = dragItem.getBoundingClientRect();
        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì offset ‡∏à‡∏≤‡∏Å parent (container) ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
        initialLeft = dragItem.offsetLeft;
        initialTop = dragItem.offsetTop;
        
        dragItem.style.cursor = "grabbing";
    }

    function handleMove(e) {
        if (!isDragging) return;
        e.preventDefault(); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡∏≤‡∏Å

        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;

        const dx = clientX - startX;
        const dy = clientY - startY;

        dragItem.style.left = `${initialLeft + dx}px`;
        dragItem.style.top = `${initialTop + dy}px`;
    }

    function handleEnd(e) {
        if (!isDragging) return;
        isDragging = false;
        dragItem.style.cursor = "grab";

        checkDrop();
    }

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏ô (Collision Detection)
    function checkDrop() {
        const itemRect = dragItem.getBoundingClientRect();
        let droppedType = null;

        // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°‡πÑ‡∏õ‡∏ó‡∏±‡∏ö‡∏ñ‡∏±‡∏á‡πÑ‡∏´‡∏ô‡∏ö‡πâ‡∏≤‡∏á
        for (const [type, binEl] of Object.entries(bins)) {
            const binRect = binEl.getBoundingClientRect();
            
            // ‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ö‡∏Å‡∏±‡∏ô (Overlap)
            if (!(itemRect.right < binRect.left || 
                  itemRect.left > binRect.right || 
                  itemRect.bottom < binRect.top || 
                  itemRect.top > binRect.bottom)) {
                droppedType = type;
                break;
            }
        }

        if (droppedType) {
            if (droppedType === currentItem.type) {
                // ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                score += 2; // ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                speak("‡πÉ‡∏ä‡πà‡∏Ñ‡∏£‡∏±‡∏ö"); // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á
                dragItem.style.backgroundColor = "#81c784"; // ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
                updateScore();
                setTimeout(spawnGarbage, 500); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏õ
            } else {
                // ‡∏ú‡∏¥‡∏î
                speak("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏£‡∏±‡∏ö"); // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á
                dragItem.classList.add("shake"); // ‡∏™‡∏±‡πà‡∏ô‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                setTimeout(() => dragItem.classList.remove("shake"), 500);
                
                // ‡πÄ‡∏î‡πâ‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏°
                dragItem.style.top = "20%";
                dragItem.style.left = "50%";
            }
        } else {
            // ‡πÑ‡∏°‡πà‡πÇ‡∏î‡∏ô‡∏ñ‡∏±‡∏á‡πÄ‡∏•‡∏¢ -> ‡πÄ‡∏î‡πâ‡∏á‡∏Å‡∏•‡∏±‡∏ö
             dragItem.style.top = "20%";
             dragItem.style.left = "50%";
        }
    }

    // Event Listeners
    document.addEventListener("mousedown", handleStart);
    document.addEventListener("mousemove", handleMove);
    document.addEventListener("mouseup", handleEnd);

    document.addEventListener("touchstart", handleStart, {passive: false});
    document.addEventListener("touchmove", handleMove, {passive: false});
    document.addEventListener("touchend", handleEnd);

</script>

</body>
</html>